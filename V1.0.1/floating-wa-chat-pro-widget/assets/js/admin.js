jQuery(function(e){"use strict";var c;var t=e("#wcw-pro-repeater"),n=e("#wcw-pro-add-agent"),a=wp.template("wcw-pro-repeater-template"),r=e('input[name="wcw_pro_settings[bubble_color]"]'),o=e('input[name="wcw_pro_settings[icon_color]"]'),i=e('input[name="wcw_pro_settings[button_style]"]'),d=e('input[name="wcw_pro_settings[button_text]"]'),l=e("#wcw-pro-preview-bubble"),s=e("#wcw-pro-preview-icon"),p=e("#wcw-pro-preview-text");function u(){var t=e('input[name="wcw_pro_settings[button_style]"]:checked').val(),c=e("#button_text_field_group");"icon_text"===t?(c.show(),l.addClass("has-text"),p.text(d.val()||'Need Help!').show()):(c.hide(),l.removeClass("has-text"),p.hide()),w()}function w(){l.css("background-color",r.val()),s.find("path").attr("fill",o.val()),p.css("color",o.val())}function f(){t.children(".wcw-pro-repeater-item").each(function(){var t=e(this),c=t.find(".wcw-pro-repeater-handle"),n=t.find(".wcw-pro-repeater-content");c.off("click.wcwpro").on("click.wcwpro",function(){t.toggleClass("open"),n.slideToggle(200)})})}e(".wcw-pro-color-picker").wpColorPicker({change:function(e,t){w()}}),n.on("click",function(c){c.preventDefault();if(e(this).parent().hasClass("wcw-pro-locked"))return;var r={index:t.children(".wcw-pro-repeater-item").length};t.append(a(r));var o=t.children(".wcw-pro-repeater-item").last();o.addClass("open").find(".wcw-pro-repeater-content").slideDown(200),f(),!wcwProData.is_pro&&t.children(".wcw-pro-repeater-item").length>=1&&e(this).parent().addClass("wcw-pro-locked")}),t.on("click",".wcw-pro-remove-agent",function(c){c.preventDefault(),confirm("Are you sure you want to remove this agent?")&&e(this).closest(".wcw-pro-repeater-item").slideUp(300,function(){e(this).remove();var c=e(".wcw-pro-add-agent-wrapper");wcwProData.is_pro||t.children(".wcw-pro-repeater-item").length<1&&c.removeClass("wcw-pro-locked")})}),t.on("keyup",".agent-name-field",function(){var t=e(this).val(),c=e(this).closest(".wcw-pro-repeater-item").find(".wcw-pro-repeater-handle h3");c.find("span").next().text(t||"New Agent")}),t.on("click",".wcw-pro-upload-image-button",function(t){if(t.preventDefault(),!e(this).is(":disabled")){var n=e(this),a=n.siblings(".wcw-pro-image-id"),r=n.closest(".wcw-pro-agent-avatar-section").find(".wcw-pro-image-preview img"),o=n.siblings(".wcw-pro-remove-image-button");c&&c.off("select"),c=wp.media({title:"Select Agent Image",button:{text:"Use this image"},multiple:!1}).on("select",function(){var e=c.state().get("selection").first().toJSON();a.val(e.id),r.attr("src",e.sizes.thumbnail?e.sizes.thumbnail.url:e.url),o.show()}),c.open()}}),t.on("click",".wcw-pro-remove-image-button",function(t){t.preventDefault();var c=e(this),n=c.closest(".wcw-pro-agent-avatar-section").find(".wcw-pro-image-preview img");c.hide().siblings(".wcw-pro-image-id").val("0"),n.attr("src","https://placehold.co/100x100/EFEFEF/AAAAAA&text=Avatar")}),e(".wcw-pro-nav-tab-wrapper .nav-tab").on("click",function(t){t.preventDefault();var c=e(this);c.addClass("nav-tab-active").siblings().removeClass("nav-tab-active");var n=c.attr("href");e(".wcw-pro-tab-content").removeClass("active"),e(n).addClass("active")}),e('input[name="wcw_pro_settings[button_style]"]').on("change",u),d.on("keyup",function(){p.text(e(this).val())}),u(),w(),f();var g=e("#api_key"),h=g.val();g.on("focus",function(){e(this).val().indexOf("âœ±")!==-1&&e(this).val("")}),g.on("blur",function(){""===e(this).val()&&e(this).val(h)}),e("#wcw-pro-request-trial-btn").on("click",function(t){t.preventDefault();var c=e(this),n=e("#wcw-pro-trial-email"),a=n.val(),r=c.siblings(".spinner"),o=e("#wcw-pro-trial-message");return a?(r.addClass("is-active"),c.prop("disabled",!0),o.hide(),void e.ajax({url:ajaxurl,type:"POST",data:{action:"wcw_pro_request_trial",email:a,nonce:wcwProData.nonce},success:function(t){t.success?(o.html(t.data.message).removeClass("error").addClass("updated notice notice-success").show(),n.val("")):o.html(t.data.message).addClass("error notice notice-error").show()},error:function(){o.html("An unknown error occurred. Please try again.").addClass("error notice notice-error").show()},complete:function(){r.removeClass("is-active"),c.prop("disabled",!1)}})):(o.html("Please enter your email address.").addClass("error notice notice-error").show(),!1)})});